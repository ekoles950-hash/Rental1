<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UGC Master & Video AI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Animasi titik-titik saat loading */
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        /* Custom scrollbar untuk hasil script */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans p-4 md:p-8 pb-24">

    <div class="max-w-3xl mx-auto space-y-6">
        
        <!-- HEADER -->
        <div class="text-center mt-2 mb-8">
            <h1 class="text-3xl md:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-rose-600 mb-2">
                üé¨ UGC Master & Video AI
            </h1>
            <p class="text-slate-500 text-sm md:text-base font-medium">Script Generator (Gemini) & Video Creator (Leonardo)</p>
        </div>

        <!-- ‚öôÔ∏è PENGATURAN API KEY -->
        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="bg-slate-100 px-5 py-3 border-b border-slate-200 flex items-center gap-2">
                <span class="text-lg">‚öôÔ∏è</span>
                <h2 class="font-bold text-slate-700">Pengaturan API Key</h2>
            </div>
            <div class="p-5 grid sm:grid-cols-2 gap-4">
                <div>
                    <label class="text-xs font-bold text-slate-600 mb-1 block">üîë API Key Gemini (Untuk Script)</label>
                    <input type="password" id="geminiKey" placeholder="Paste API Key Gemini di sini..." class="w-full p-2.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-400 outline-none bg-slate-50 transition-all">
                </div>
                <div>
                    <label class="text-xs font-bold text-slate-600 mb-1 block">üîë API Key Leonardo (Untuk Video)</label>
                    <input type="password" id="leonardoKey" placeholder="Paste API Key Leonardo di sini..." class="w-full p-2.5 text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-rose-400 outline-none bg-slate-50 transition-all">
                </div>
            </div>
        </div>

        <!-- üìù STEP 1: SCRIPT CREATOR -->
        <div class="bg-white rounded-2xl shadow-md border border-slate-200 overflow-hidden">
            <div class="bg-red-50 px-5 py-4 border-b border-red-100 flex items-center gap-3">
                <span class="bg-red-600 text-white w-6 h-6 rounded-full flex justify-center items-center text-xs font-bold shadow-sm">1</span>
                <h2 class="font-bold text-red-800">Buat Script UGC (Gemini AI)</h2>
            </div>

            <div class="p-5 space-y-5">
                <!-- Upload Foto -->
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">Foto Produk (Wajib)</label>
                    <div id="uploadAreaProduk" class="border-2 border-dashed border-slate-300 rounded-xl p-6 flex flex-col items-center justify-center cursor-pointer hover:bg-red-50 hover:border-red-300 transition-all" onclick="document.getElementById('fileProduk').click()">
                        <span class="text-3xl mb-2">üì∏</span>
                        <p class="text-sm text-slate-500 font-medium">Klik untuk upload foto produk</p>
                    </div>
                    <input type="file" id="fileProduk" accept="image/*" class="hidden" onchange="previewFile(event, 'previewImgProduk', 'uploadAreaProduk')">
                    
                    <!-- Preview Foto -->
                    <div id="previewContainerProduk" class="hidden relative rounded-xl overflow-hidden border border-slate-200 mt-2 sm:w-1/2 group">
                        <img id="previewImgProduk" class="w-full h-48 object-cover">
                        <button onclick="hapusPreview('previewContainerProduk', 'uploadAreaProduk', 'fileProduk')" class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-sm font-bold">
                            ‚ùå Hapus Foto
                        </button>
                    </div>
                </div>

                <!-- Pilihan Talent & Info -->
                <div class="grid sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Talent UGC</label>
                        <select id="talentPilihan" class="w-full p-3 text-sm border border-slate-300 rounded-lg bg-white outline-none focus:ring-2 focus:ring-red-400">
                            <option value="woman">üë© Wanita (Ceria/Keibuan)</option>
                            <option value="man">üë® Pria (Tegas/Maskulin)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-slate-700 mb-2">Info Tambahan (Opsional)</label>
                        <input type="text" id="infoProduk" placeholder="Contoh: Fokus ke sol empuk, anti licin..." class="w-full p-3 text-sm border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-red-400">
                    </div>
                </div>

                <!-- Tombol Action Script -->
                <button id="btnBuatScript" onclick="prosesScript()" class="w-full py-3.5 rounded-xl font-bold text-white shadow-md bg-gradient-to-r from-red-600 to-rose-600 hover:opacity-90 transition-opacity flex justify-center items-center gap-2">
                    ‚ö° Generate Skenario Script
                </button>
                <div id="statusScript" class="hidden text-center text-sm font-bold text-red-600 p-3 bg-red-50 rounded-lg border border-red-100"></div>
            </div>

            <!-- Hasil Script -->
            <div id="hasilScriptContainer" class="hidden bg-slate-900 p-5 border-t">
                <div class="flex justify-between items-center mb-4">
                    <span class="bg-rose-500 text-white text-[10px] font-black px-2 py-1 rounded uppercase shadow-sm">üìö Hasil Script AI</span>
                    <button onclick="salinSemuaScript()" class="text-xs bg-white text-slate-900 font-bold px-3 py-1.5 rounded hover:bg-slate-200 transition-colors">üìã Salin Teks</button>
                </div>
                <div id="wadahSceneScript" class="space-y-4 max-h-[400px] overflow-y-auto custom-scroll pr-2">
                    <!-- Scene diload lewat JS -->
                </div>
            </div>
        </div>

        <!-- üé• STEP 2: VIDEO CREATOR -->
        <div class="bg-white rounded-2xl shadow-md border border-slate-200 overflow-hidden mt-6">
            <div class="bg-blue-50 px-5 py-4 border-b border-blue-100 flex items-center gap-3">
                <span class="bg-blue-600 text-white w-6 h-6 rounded-full flex justify-center items-center text-xs font-bold shadow-sm">2</span>
                <h2 class="font-bold text-blue-900">Render Video (Leonardo AI)</h2>
            </div>

            <div class="p-5 space-y-5">
                <!-- Resolusi -->
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">Resolusi Video</label>
                    <select id="resolusiPilihan" class="w-full p-3 text-sm border border-slate-300 rounded-lg bg-white outline-none focus:ring-2 focus:ring-blue-400">
                        <option value="9:16">üì± TikTok / Reels (9:16 Vertical)</option>
                        <option value="16:9">üíª YouTube (16:9 Horizontal)</option>
                    </select>
                </div>

                <!-- Upload Frame -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-600 mb-2">Start Frame (Awal) *</label>
                        <div id="uploadAreaStart" class="border-2 border-dashed border-slate-300 rounded-xl h-28 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-all" onclick="document.getElementById('fileStart').click()">
                            <span class="text-2xl mb-1">üñºÔ∏è</span>
                            <span class="text-[10px] text-slate-500 font-bold">Upload Start</span>
                        </div>
                        <input type="file" id="fileStart" accept="image/*" class="hidden" onchange="previewFile(event, 'previewImgStart', 'uploadAreaStart')">
                        
                        <div id="previewContainerStart" class="hidden relative rounded-xl overflow-hidden border border-slate-200 h-28 group">
                            <img id="previewImgStart" class="w-full h-full object-cover">
                            <button onclick="hapusPreview('previewContainerStart', 'uploadAreaStart', 'fileStart')" class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold">‚ùå Hapus</button>
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-600 mb-2">End Frame (Akhir) <span class="font-normal text-slate-400">(Opsional)</span></label>
                        <div id="uploadAreaEnd" class="border-2 border-dashed border-slate-300 rounded-xl h-28 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-50 hover:border-blue-300 transition-all" onclick="document.getElementById('fileEnd').click()">
                            <span class="text-2xl mb-1">üñºÔ∏è</span>
                            <span class="text-[10px] text-slate-500 font-bold">Upload End</span>
                        </div>
                        <input type="file" id="fileEnd" accept="image/*" class="hidden" onchange="previewFile(event, 'previewImgEnd', 'uploadAreaEnd')">
                        
                        <div id="previewContainerEnd" class="hidden relative rounded-xl overflow-hidden border border-slate-200 h-28 group">
                            <img id="previewImgEnd" class="w-full h-full object-cover">
                            <button onclick="hapusPreview('previewContainerEnd', 'uploadAreaEnd', 'fileEnd')" class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold">‚ùå Hapus</button>
                        </div>
                    </div>
                </div>

                <!-- Prompt Video -->
                <div>
                    <label class="block text-sm font-bold text-slate-700 mb-2">Prompt Animasi Video *</label>
                    <textarea id="promptVideo" rows="4" placeholder="Paste panduan VISUAL dari Step 1 ke sini... (Atau ketik instruksi gerakan kamera)" class="w-full p-3 text-sm border border-slate-300 rounded-xl outline-none focus:ring-2 focus:ring-blue-400 resize-none"></textarea>
                </div>

                <!-- Tombol Action Video -->
                <button id="btnBuatVideo" onclick="prosesVideo()" class="w-full py-3.5 rounded-xl font-bold text-white shadow-md bg-gradient-to-r from-blue-600 to-indigo-600 hover:opacity-90 transition-opacity flex justify-center items-center gap-2">
                    üé• Generate Video (Leonardo)
                </button>
                <div id="statusVideo" class="hidden text-center text-sm font-bold text-blue-700 p-3 bg-blue-50 border border-blue-100 rounded-lg"></div>

                <!-- Hasil Video Selesai -->
                <div id="hasilVideoContainer" class="hidden mt-6 p-4 bg-green-50 border border-green-200 rounded-xl text-center shadow-sm">
                    <h3 class="font-bold text-green-700 mb-3 text-lg flex items-center justify-center gap-2">‚úÖ Video Berhasil Dibuat!</h3>
                    <video id="playerVideo" controls autoplay loop class="w-full rounded-lg shadow-lg bg-black"></video>
                </div>
            </div>
        </div>

    </div>

    <!-- LOGIKA JAVASCRIPT -->
    <script>
        // Key bawaan environment (jika ada di dalam sistem preview)
        const envApiKey = ""; 

        // Variabel Global
        let base64ImgProduk = null;
        let mimeImgProduk = null;
        let dataScriptRaw = [];

        // Utilities
        function showEl(id) { document.getElementById(id).classList.remove('hidden'); }
        function hideEl(id) { document.getElementById(id).classList.add('hidden'); }

        // Preview & Hapus Gambar Umum
        function previewFile(e, imgId, uploadAreaId) {
            const file = e.target.files[0];
            if(file) {
                const url = URL.createObjectURL(file);
                document.getElementById(imgId).src = url;
                
                // Sembunyikan area upload, tampilkan preview
                if(uploadAreaId === 'uploadAreaProduk') {
                    hideEl('uploadAreaProduk');
                    showEl('previewContainerProduk');
                    
                    // Convert ke Base64 untuk produk (Gemini)
                    const reader = new FileReader();
                    reader.onload = () => {
                        base64ImgProduk = reader.result.split(',')[1];
                        mimeImgProduk = reader.result.split(';')[0].split(':')[1];
                    };
                    reader.readAsDataURL(file);
                } else if (uploadAreaId === 'uploadAreaStart') {
                    hideEl('uploadAreaStart');
                    showEl('previewContainerStart');
                } else if (uploadAreaId === 'uploadAreaEnd') {
                    hideEl('uploadAreaEnd');
                    showEl('previewContainerEnd');
                }
            }
        }

        function hapusPreview(containerId, uploadAreaId, inputId) {
            document.getElementById(inputId).value = '';
            hideEl(containerId);
            showEl(uploadAreaId);
            
            if(inputId === 'fileProduk') {
                base64ImgProduk = null;
                mimeImgProduk = null;
            }
        }

        // ==========================================
        // LOGIKA STEP 1: SCRIPT GEMINI
        // ==========================================
        async function prosesScript() {
            const userKey = document.getElementById('geminiKey').value.trim();
            const finalApiKey = userKey || envApiKey; // Gunakan key user, jika kosong pakai key environment
            
            const talent = document.getElementById('talentPilihan').value;
            const info = document.getElementById('infoProduk').value.trim();
            const btn = document.getElementById('btnBuatScript');
            const statusBox = document.getElementById('statusScript');

            hideEl('statusScript');
            hideEl('hasilScriptContainer');

            if(!finalApiKey) { 
                statusBox.innerText = "‚ùå Silakan masukkan API Key Gemini di Pengaturan!"; 
                showEl('statusScript'); 
                return; 
            }
            if(!base64ImgProduk) { 
                statusBox.innerText = "‚ùå Upload Foto Produk terlebih dahulu!"; 
                showEl('statusScript'); 
                return; 
            }

            // State Loading
            btn.disabled = true;
            btn.classList.add('opacity-70', 'cursor-not-allowed');
            btn.innerHTML = '<span class="loading-dots">‚è≥ Menganalisis Gambar AI</span>';

            try {
                const promptTarget = talent === 'man' ? 'Pria (Maskulin/Tegas)' : 'Wanita (Ceria/Keibuan)';
                const systemPromptText = `
Anda adalah UGC Creator Expert. Analisis gambar produk, lalu buat SKENARIO VIDEO UGC (3 SCENE).
Target Talent: ${promptTarget}. Info tambahan: ${info}.

ATURAN WAJIB OUTPUT:
- HARUS berformat JSON Array murni. Tidak boleh ada teks markdown seperti \`\`\`json.
- Format JSON persis seperti ini:
[
  { "scene": "1. HOOK (Opening Shot)", "visual": "Talent mengambil produk. The product must remain identical...", "audio": "Kalimat hook menarik maksimal 146 huruf." },
  { "scene": "2. REVIEW (Detail)", "visual": "Kamera fokus ke produk. Jempol menekan...", "audio": "Penjelasan fitur dan keunggulan." },
  { "scene": "3. CTA (Closing)", "visual": "Talent menunjuk ke bawah (arah keranjang)...", "audio": "Ajakan checkout tegas." }
]`;

                // Request ke API Gemini
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${finalApiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ 
                            role: "user", 
                            parts: [
                                { text: systemPromptText }, 
                                { inlineData: { mimeType: mimeImgProduk, data: base64ImgProduk } }
                            ] 
                        }],
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                const data = await response.json();
                if(data.error) throw new Error(data.error.message);

                let rawTeks = data.candidates[0].content.parts[0].text;
                
                // Bersihkan respon JSON dari markdown jika ada
                rawTeks = rawTeks.replace(/```json/g, '').replace(/```/g, '').trim();
                const startIdx = rawTeks.indexOf('[');
                const endIdx = rawTeks.lastIndexOf(']');
                
                if (startIdx === -1 || endIdx === -1) throw new Error("Format respon AI tidak sesuai.");
                
                dataScriptRaw = JSON.parse(rawTeks.substring(startIdx, endIdx + 1));
                
                tampilkanScript(dataScriptRaw);

            } catch(err) {
                statusBox.innerText = "‚ùå Gagal: " + err.message;
                showEl('statusScript');
            } finally {
                btn.disabled = false;
                btn.classList.remove('opacity-70', 'cursor-not-allowed');
                btn.innerHTML = '‚ö° Generate Skenario Script';
            }
        }

        function tampilkanScript(scenes) {
            const wadah = document.getElementById('wadahSceneScript');
            wadah.innerHTML = ''; 
            
            scenes.forEach(s => {
                wadah.innerHTML += `
                    <div class="bg-slate-800 p-4 rounded-xl border-l-4 border-rose-500 shadow-md">
                        <span class="text-[10px] font-bold bg-rose-900/60 text-rose-300 px-2.5 py-1 rounded tracking-widest">${s.scene}</span>
                        <div class="mt-3">
                            <span class="text-[10px] bg-blue-900/50 text-blue-300 px-2 py-0.5 rounded font-bold uppercase">üé• Visual</span>
                            <p class="text-xs text-slate-300 mt-1.5 leading-relaxed">${s.visual}</p>
                        </div>
                        <div class="mt-3">
                            <span class="text-[10px] bg-green-900/50 text-green-300 px-2 py-0.5 rounded font-bold uppercase">üé§ Narasi</span>
                            <p class="text-sm font-medium text-white italic mt-1.5">"${s.audio}"</p>
                        </div>
                    </div>`;
            });
            
            // Auto-fill prompt video
            if(scenes.length > 0) {
                document.getElementById('promptVideo').value = scenes[0].visual;
            }
            showEl('hasilScriptContainer');
        }

        function salinSemuaScript() {
            if(dataScriptRaw.length === 0) return;
            const talentTxt = document.getElementById('talentPilihan').value === 'man' ? 'Pria' : 'Wanita';
            
            let fullText = `[Konsep UGC - ${talentTxt}]\n[Teknis: Negatif no blur no watermark. Diam di tempat. Fokus tajam.]\n\n`;
            dataScriptRaw.forEach(s => fullText += `--- ${s.scene} ---\nVISUAL: ${s.visual}\nNARASI: "${s.audio}"\n\n`);

            const el = document.createElement('textarea');
            el.value = fullText;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            
            alert('Berhasil! Teks script telah disalin ke clipboard.');
        }

        // ==========================================
        // LOGIKA STEP 2: VIDEO LEONARDO AI
        // ==========================================
        async function uploadGambarKeLeonardo(file, apiKey) {
            // Init Image API
            const initRes = await fetch('https://cloud.leonardo.ai/api/rest/v1/init-image', {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${apiKey}`, 'Content-Type': 'application/json' },
                body: JSON.stringify({ extension: file.name.split('.').pop() })
            });
            const initData = await initRes.json();
            if(!initData.uploadInitImage) throw new Error("API Key Leonardo tidak valid atau akses ditolak.");
            
            // Upload ke S3
            const fd = new FormData();
            const fields = JSON.parse(initData.uploadInitImage.fields);
            for (let k in fields) fd.append(k, fields[k]);
            fd.append('file', file);
            
            const upRes = await fetch(initData.uploadInitImage.url, { method: 'POST', body: fd });
            if(!upRes.ok) throw new Error("Gagal mengupload gambar fisik ke server.");

            return initData.uploadInitImage.id; 
        }

        async function prosesVideo() {
            const apiKey = document.getElementById('leonardoKey').value.trim();
            const fileStart = document.getElementById('fileStart').files[0];
            const fileEnd = document.getElementById('fileEnd').files[0];
            const prompt = document.getElementById('promptVideo').value.trim();
            const resolusi = document.getElementById('resolusiPilihan').value;
            
            const btn = document.getElementById('btnBuatVideo');
            const statusBox = document.getElementById('statusVideo');

            hideEl('statusVideo');
            hideEl('hasilVideoContainer');

            // Validasi
            if(!apiKey) { statusBox.innerText = "‚ùå Silakan masukkan API Key Leonardo di Pengaturan!"; showEl('statusVideo'); return; }
            if(!fileStart) { statusBox.innerText = "‚ùå Start Frame wajib diupload!"; showEl('statusVideo'); return; }
            if(!prompt) { statusBox.innerText = "‚ùå Prompt Video wajib diisi!"; showEl('statusVideo'); return; }

            // State Loading
            btn.disabled = true;
            btn.classList.add('opacity-70', 'cursor-not-allowed');

            try {
                // 1. Upload Start Frame
                statusBox.innerHTML = '<span class="loading-dots">1/3: Mengunggah Start Frame ke AI</span>';
                showEl('statusVideo');
                const startId = await uploadGambarKeLeonardo(fileStart, apiKey);

                // 2. Upload End Frame (Bila Ada)
                let endId = null;
                if(fileEnd) {
                    statusBox.innerHTML = '<span class="loading-dots">1.5/3: Mengunggah End Frame</span>';
                    endId = await uploadGambarKeLeonardo(fileEnd, apiKey);
                }

                // 3. Render
                statusBox.innerHTML = '<span class="loading-dots">2/3: Mengirim Instruksi & Mulai Render</span>';
                
                const resolusiTeks = resolusi === '9:16' ? 'Vertical 9:16 aspect ratio' : 'Horizontal 16:9 aspect ratio';
                const payloadVideo = { 
                    imageId: startId, 
                    prompt: `${prompt}. ${resolusiTeks}`, 
                    isPublic: false 
                };

                const renderRes = await fetch('https://cloud.leonardo.ai/api/rest/v1/generations-motion-svd', {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${apiKey}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify(payloadVideo)
                });
                
                const renderData = await renderRes.json();
                if(!renderData.motionSvdGenerationJob) throw new Error(renderData.error || "Gagal memulai render. Cek saldo koin/kredit Leonardo Anda.");

                // 4. Polling Status
                statusBox.innerHTML = '<span class="loading-dots">3/3: Video diproses AI (Tunggu 1-3 Menit)</span>';
                cekStatusVideo(renderData.motionSvdGenerationJob.generationId, apiKey);

            } catch(e) {
                statusBox.innerText = "‚ùå Gagal: " + e.message;
                btn.disabled = false;
                btn.classList.remove('opacity-70', 'cursor-not-allowed');
            }
        }

        // Cek API setiap 6 detik
        function cekStatusVideo(generationId, apiKey) {
            const timerPolling = setInterval(async () => {
                try {
                    const res = await fetch(`https://cloud.leonardo.ai/api/rest/v1/generations/${generationId}`, {
                        headers: { 'Authorization': `Bearer ${apiKey}`, 'Accept': 'application/json' }
                    });
                    const data = await res.json();
                    const statusVal = data.generations_by_pk?.status;

                    if(statusVal === "COMPLETE") {
                        // Selesai
                        clearInterval(timerPolling);
                        const videoUrl = data.generations_by_pk.generated_images[0].motionMP4URL;
                        
                        document.getElementById('playerVideo').src = videoUrl;
                        hideEl('statusVideo');
                        showEl('hasilVideoContainer');
                        
                        // Kembalikan tombol
                        const btn = document.getElementById('btnBuatVideo');
                        btn.disabled = false;
                        btn.classList.remove('opacity-70', 'cursor-not-allowed');
                        
                        // Scroll otomatis ke hasil
                        document.getElementById('hasilVideoContainer').scrollIntoView({ behavior: 'smooth', block: 'end' });

                    } else if(statusVal === "FAILED") {
                        // Gagal
                        clearInterval(timerPolling);
                        throw new Error("Proses render digagalkan oleh server Leonardo.");
                    }
                } catch(e) {
                    if(e.message === "Proses render digagalkan oleh server Leonardo.") {
                        document.getElementById('statusVideo').innerText = "‚ùå " + e.message;
                        const btn = document.getElementById('btnBuatVideo');
                        btn.disabled = false;
                        btn.classList.remove('opacity-70', 'cursor-not-allowed');
                    }
                }
            }, 6000); 
        }
    </script>
</body>
</html>